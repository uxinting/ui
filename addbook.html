<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>漂流</title>
	<link rel="stylesheet" href="static/bootstrap3/css/bootstrap.css" />
	<link rel="stylesheet" href="static/css/book.css" />
</head>
<style>
.list-group {
	margin-top: 20px;
}
.list-group-item {
	margin: 10px 20%;
}
.list-group-item > p {
	float: right;
}
.list-group-item > span {
	position: absolute;
	top: 20px;
	right: 20px;
}
.list-group-item > span:hover {
	cursor: pointer;
}
</style>
<body>
<nav class="navbar navbar-default" role="navigation">
	<div class="navbar-header">
		<a class="navbar-brand" href="/">Book Drift</a>
	</div>
	<ul class="nav navbar-nav">
		<li><a href="#add-tag" data-toggle="modal" title="添加新的标签"><span class="glyphicon glyphicon-tag"></span></a></li>
		<li><a href="#" title="分享新的书籍"><span class="glyphicon glyphicon-book"></span></a></li>
	</ul>
	<ul class="nav navbar-nav pull-right" data-with="bool: user">
		<li><a href="#"><span class="glyphicon glyphicon-envelope"></span><strong class="icon-badge">1</strong></a></li>
		<li><a href="#" data-with="text: user.userName"></a></li>
	</ul>
</nav>
<div class="container">
	<div class="row">
		<div class="input-group	 col-lg-4 col-lg-offset-4">
			<input class="form-control" placeholder="书籍关键字">
			<span class="input-group-btn">
				<button class="btn btn-default" type="button" title="搜索"><span class="glyphicon glyphicon-search"></span></button>
			</span>
		</div>
	</div>
	<div id="books">
	<ul data-with="list: books" class="list-group">
		<example>
			<li class="list-group-item">
			<h3 data-with="text: title"></h3>
			<img data-with="src: image">
			<span class="glyphicon glyphicon-share"></span>
			<small data-with="text: author"></small>
			<p data-with="text: publisher"></p>
			</li>
		</example>
	</ul>
	</div>
</div>

<div class="modal fade" id="add-tag" tabindex="-1" role="dialog" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				添加新的标签
			</div>
			<div class="modal-body">
				<label>标签号</label>
				<input type="text" class="form-control">
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-primary">确定</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="add-book" tabindex="-1" role="dialog" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				分享新的书籍
			</div>
			<div class="modal-body">
				<label>ISBN</label>
				<p><input class="form-control" type="number" ></p>
				<table class="table table-hover">
				<tbody>
					<tr>
					<td><b>书名</b></td>
					<td data-with="text: title"></td>
					</tr>
					<tr>
					<b>作者</b>
					<td data-with="text: author"></td>
					</tr>
					<tr>
					<b>出版社</b>
					<td data-with="text: publisher"></td>
					</tr>
				</tbody>
				</table>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-primary">确定</button>
			</div>
		</div>
	</div>
</div>

<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
<script src="static/bootstrap3/js/bootstrap.js" ></script>
<script src="../../with/with-1.1.1/js/with-1.1.1.js"></script>
<script src="../../douban/douban/js/douban.js"></script>
<script>
$(function(){
	$( '#tags [data-toggle="tab"]' ).on( 'show.bs.tab', function ( e ) {
		$( e.relatedTarget ).find( 'span' ).remove().appendTo( $( e.target ) );
	} );
	
	$('.thumbnail').hover(function(){
		$(this).find('.status').slideToggle();
	});
	
	$('.status').find('li').click(function(){
		var claz = $(this).find('span').attr('class')+'-sign';
		$(this).parent('ul').siblings('span').attr('class', claz);
	});
	
	$('.nav-pills').find('li').draggable({
		revert: 'invalid'
	});
	
	$('#trash').droppable({
		drop: function ( event, ui ) {
			ui.draggable.remove();
		},
		hoverClass: 'btn-danger'
	});
	
	$( '#add-book' ).find( '.modal-footer button' ).click( function () {
		var isbn = $( '#add-book' ).find( '.modal-body input' ).val();
		var data = new douban().askBookByIsbn( isbn, function( data ) {
			$( '#add-book' ).fill( data );
		} );
	} );
	
	new douban().searchBooksByKeys( 'Java ee', function( data ) {
		$( '#books' ).fill( data );
	} );
});
</script>
</body>
</html>