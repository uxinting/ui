/*!*
*	Yellow Text
*	=========================================
*	This plugin is created to make text editing
*	more fun and to make it easy for the editor.
*
*	Version: 0.4.2
*	Author: Stefan Vermaas
*	URL: www.stefanvermaas.nl
*
*/(function(e){var t={init:function(n,r){t.el=n;t.settings=e.extend({width:"100%",height:"300px",containerClass:"js-editor-container",buttonsClass:"js-editor-buttons",iFrameClass:"js-editor-iframe",cleanOnSubmit:!0,defaultFont:"Helvetica Neue, Helvetica, arial, sans-serief",defaultFontSize:"1em",defaultFontColor:"#000000",defaultActions:"bold, underline, italic, strikethrough, align-left, align-center, align-right, unordered-list, ordered-list, link, image",isContentChanged:function(){},setImage:function(){}},r);t.render();t.setContent();t.events()},render:function(){t.createTextEditor();t.createButtons()},createTextEditor:function(){e(t.el).hide();t.container=e("<div />").addClass(t.settings.containerClass).css({"float":"left",width:t.settings.width,border:"1px solid #ccc"});e(t.el).after(t.container);t.editor=e("<iframe />").addClass(t.settings.iFrameClass).css({"float":"left",width:t.settings.width,height:t.settings.height,border:"0",overflow:"hidden"}).appendTo(t.container).get(0);t.editor.contentWindow.document.open();t.editor.contentWindow.document.close();t.editor.contentWindow.document.designMode="on";e(t.editor).contents().find("body").css({"word-wrap":"break-word","font-family":t.settings.defaultFont,"font-size":t.settings.defaultFontSize,color:t.settings.defaultFontColor});e(t.editor).contents().find("body").append("<p><br /></p>");var n='<style type="text/css">body{padding:2%;}p{margin:0;}</style>';e(t.editor).contents().find("head").append(n);t.buttons=e("<div />").addClass(t.settings.buttonsClass).css({"float":"left",width:t.settings.width}).prependTo(t.container)},setContent:function(){var n=e(t.el).text();e(t.editor).contents().find("body").append(n)},createButtons:function(){var n=t.settings.defaultActions.split(/, ?/);for(i=0;i<n.length;i++){var r;switch(n[i]){case"bold":r={content:"b",command:"bold"};break;case"underline":r={content:"u",command:"underline"};break;case"italic":r={content:"i",command:"italic"};break;case"strikethrough":r={content:"s",command:"strikethrough"};break;case"align-left":r={content:"left",command:"JustifyLeft"};break;case"align-center":r={content:"center",command:"JustifyCenter"};break;case"align-right":r={content:"right",command:"JustifyRight"};break;case"unordered-list":r={content:"ul",command:"InsertUnorderedList"};break;case"ordered-list":r={content:"ol",command:"InsertOrderedList"};break;case"image":r={content:"img",command:"image"};break;case"link":r={content:"link",command:"link"};break;default:r={content:"",command:""}}e("<a />").addClass(r.command).text(r.content).data("command",r.command).appendTo(t.buttons)}},events:function(){e("."+t.settings.buttonsClass+" a").on("click",function(n){var r=e(this).data("command");t.buttonClicked(n,r);(r==="InsertUnorderedList"||r==="InsertOrderedList")&&t.cleanLists(r)});e(t.editor).contents().find("body").on("keydown",function(e){(e.ctrlKey||e.metaKey)&&t.shortkey(e,this)});e(t.editor).contents().find("body").on("keyup",function(n){var r=e(t.editor).contents().find("body").html()!==e(t.el).text()?!0:!1;t.settings.isContentChanged(r)});e(t.el).parents("form").on("submit",function(e){t.cleanTheCode();t.putContentBack()})},buttonClicked:function(e,n){t.editor.contentWindow.focus();t.runCMD(n);t.editor.contentWindow.focus()},shortkey:function(e){var n=e.which;if(n===66||n===73||n===85){t.editor.contentWindow.focus();switch(n){case 66:t.runCMD("bold");break;case 73:t.runCMD("italic");break;case 85:t.runCMD("underline")}t.editor.contentWindow.focus()}},runCMD:function(e){if(e==="image"){if(typeof t.settings.setImage=="function")var n=t.settings.setImage.call();var r=typeof n!="undefined"&&n.length>0?n:prompt("URL (example: http://www.google.com): ");return t.editor.contentWindow.document.execCommand("InsertImage",!1,r)}if(e==="link"){var i=prompt("URL (example: http://www.google.com): ");return t.editor.contentWindow.document.execCommand("CreateLink",!1,i)}return t.editor.contentWindow.document.execCommand(e)},cleanTheCode:function(){e(t.editor).contents().find("body").find("br").removeAttr("class").unwrap()},cleanLists:function(n){var r=n==="InsertUnorderedList"?"ul":"ol";e(t.editor).contents().find("body").find(r).removeAttr("class").unwrap()},putContentBack:function(){var n=e(t.editor).contents().find("body").html();e(t.el).val(n)}};e.fn.texteditor=function(n){return this.each(function(){if(t[n])return t[n].apply(this,Array.prototype.slice.call(arguments,1));if(typeof n=="object"||!n)return t.init(this,n);e.error("Method "+n+" does not exist on jQuery.texteditor")})}})(jQuery);